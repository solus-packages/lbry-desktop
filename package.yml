name       : lbry-desktop
version    : 0.46.2
release    : 61
source     :
    - https://github.com/lbryio/lbry-desktop/archive/v0.46.2.tar.gz : a731f2c1907bc5fbab9c794a139dac79a14b2dfae36c42b05b5d40719744f0ce
license    : MIT
component  : multimedia.video
networking : yes
summary    : This is a graphical browser for the decentralized content marketplace provided by the LBRY protocol
description: |
    This is a graphical browser for the decentralized content marketplace provided by the LBRY protocol.
replaces   :
    - lbry-app
builddeps  :
    - pkgconfig(alsa)
    - pkgconfig(gtk+-3.0)
    - pkgconfig(libsecret-1)
    - pkgconfig(xcomposite)
    - pkgconfig(xcursor)
    - pkgconfig(xrandr)
    - pkgconfig(xscrnsaver)
    - pkgconfig(xtst)
    - git
    - wget
    - yarn
rundeps    :
    - gnome-keyring
setup      : |
    %patch -p1 < $pkgfiles/0001-Update-some-babel-deps-to-resolve-failure-to-get-com.patch
    yarn
build      : |
    yarn build:dir
    for arch in arm arm64 ia32; do
        find . -name "${arch}" -type d -exec rm -rf {} +
    done
install    : |
    install -dm00755 $installdir/usr/bin
    install -dm00644 $installdir/usr/share/lbry-desktop
    cp -R dist/electron/linux-unpacked/* $installdir/usr/share/lbry-desktop/
    ln -s /usr/share/lbry-desktop/lbry $installdir/usr/bin/lbry
    install -Dm00644 $pkgfiles/lbry-desktop.desktop $installdir/usr/share/applications/lbry-desktop.desktop
    install -Dm00644 build/icons/256x256.png $installdir/usr/share/pixmaps/lbry.png
    # App update disable mechanism
    touch $installdir/usr/share/lbry-desktop/resources/static/upgradeDisabled
    chmod 00644 $installdir/usr/share/lbry-desktop/resources/static/upgradeDisabled
